#!/bin/bash

# write config file
touch > /etc/vsftpd.conf
echo "allow_anon_ssl=$ALLOW_ANON_SSL" >> /etc/vsftpd.conf
echo "anon_mkdir_write_enable=$ANON_MKDIR_WRITE_ENABLE" >> /etc/vsftpd.conf
echo "anon_other_write_enable=$ANON_OTHER_WRITE_ENABLE" >> /etc/vsftpd.conf
echo "anon_upload_enable=$ANON_UPLOAD_ENABLE" >> /etc/vsftpd.conf
echo "anon_world_readable_only=$ANON_WORLD_READABLE_ONLY" >> /etc/vsftpd.conf
echo "anonymous_enable=$ANONYMOUS_ENABLE" >> /etc/vsftpd.conf
echo "ascii_download_enable=$ASCII_DOWNLOAD_ENABLE" >> /etc/vsftpd.conf
echo "ascii_upload_enable=$ASCII_UPLOAD_ENABLE" >> /etc/vsftpd.conf
echo "async_abor_enable=$ASYNC_ABOR_ENABLE" >> /etc/vsftpd.conf
echo "background=$BACKGROUND" >> /etc/vsftpd.conf
echo "check_shell=$CHECK_SHELL" >> /etc/vsftpd.conf
echo "chmod_enable=$CHMOD_ENABLE" >> /etc/vsftpd.conf
echo "chown_uploads=$CHOWN_UPLOADS" >> /etc/vsftpd.conf
echo "chroot_list_enable=$CHROOT_LIST_ENABLE" >> /etc/vsftpd.conf
echo "chroot_local_user=$CHROOT_LOCAL_USER" >> /etc/vsftpd.conf
echo "connect_from_port_20=$CONNECT_FROM_PORT_20" >> /etc/vsftpd.conf
echo "debug_ssl=$DEBUG_SSL" >> /etc/vsftpd.conf
echo "delete_failed_uploads=$DELETE_FAILED_UPLOADS" >> /etc/vsftpd.conf
echo "deny_email_enable=$DENY_EMAIL_ENABLE" >> /etc/vsftpd.conf
echo "dirlist_enable=$DIRLIST_ENABLE" >> /etc/vsftpd.conf
echo "dirmessage_enable=$DIRMESSAGE_ENABLE" >> /etc/vsftpd.conf
echo "download_enable=$DOWNLOAD_ENABLE" >> /etc/vsftpd.conf
echo "dual_log_enable=$DUAL_LOG_ENABLE" >> /etc/vsftpd.conf
echo "force_dot_files=$FORCE_DOT_FILES" >> /etc/vsftpd.conf
echo "force_anon_data_ssl=$FORCE_ANON_DATA_SSL" >> /etc/vsftpd.conf
echo "force_anon_logins_ssl=$FORCE_ANON_LOGINS_SSL" >> /etc/vsftpd.conf
echo "force_local_data_ssl=$FORCE_LOCAL_DATA_SSL" >> /etc/vsftpd.conf
echo "force_local_logins_ssl=$FORCE_LOCAL_LOGINS_SSL" >> /etc/vsftpd.conf
echo "guest_enable=$GUEST_ENABLE" >> /etc/vsftpd.conf
echo "hide_ids=$HIDE_IDS" >> /etc/vsftpd.conf
echo "implicit_ssl=$IMPLICIT_SSL" >> /etc/vsftpd.conf
echo "listen=$LISTEN" >> /etc/vsftpd.conf
echo "listen_ipv6=$LISTEN_IPV6" >> /etc/vsftpd.conf
echo "local_enable=$LOCAL_ENABLE" >> /etc/vsftpd.conf
echo "lock_upload_files=$LOCK_UPLOAD_FILES" >> /etc/vsftpd.conf
echo "log_ftp_protocol=$LOG_FTP_PROTOCOL" >> /etc/vsftpd.conf
echo "ls_recurse_enable=$LS_RECURSE_ENABLE" >> /etc/vsftpd.conf
echo "mdtm_write=$MDTM_WRITE" >> /etc/vsftpd.conf
echo "no_anon_password=$NO_ANON_PASSWORD" >> /etc/vsftpd.conf
echo "no_log_lock=$NO_LOG_LOCK" >> /etc/vsftpd.conf
echo "one_process_model=$ONE_PROCESS_MODEL" >> /etc/vsftpd.conf
echo "passwd_chroot_enable=$PASSWD_CHROOT_ENABLE" >> /etc/vsftpd.conf
echo "pasv_addr_resolve=$PASV_ADDR_RESOLVE" >> /etc/vsftpd.conf
echo "pasv_enable=$PASV_ENABLE" >> /etc/vsftpd.conf
echo "pasv_promiscuous=$PASV_PROMISCUOUS" >> /etc/vsftpd.conf
echo "port_enable=$PORT_ENABLE" >> /etc/vsftpd.conf
echo "port_promiscuous=$PORT_PROMISCUOUS" >> /etc/vsftpd.conf
echo "require_cert=$REQUIRE_CERT" >> /etc/vsftpd.conf
echo "require_ssl_reuse=$REQUIRE_SSL_REUSE" >> /etc/vsftpd.conf
echo "run_as_launching_user=$RUN_AS_LAUNCHING_USER" >> /etc/vsftpd.conf
echo "secure_email_list_enable=$SECURE_EMAIL_LIST_ENABLE" >> /etc/vsftpd.conf
echo "session_support=$SESSION_SUPPORT" >> /etc/vsftpd.conf
echo "setproctitle_enable=$SETPROCTITLE_ENABLE" >> /etc/vsftpd.conf
echo "ssl_enable=$SSL_ENABLE" >> /etc/vsftpd.conf
echo "ssl_request_cert=$ssl_request_cert" >> /etc/vsftpd.conf
echo "ssl_sslv2=$SSL_SSLV2" >> /etc/vsftpd.conf
echo "ssl_sslv3=$SSL_SSLV3" >> /etc/vsftpd.conf
echo "ssl_tlsv1=$SSL_TLSV1" >> /etc/vsftpd.conf
echo "strict_ssl_read_eof=$STRICT_SSL_READ_EOF" >> /etc/vsftpd.conf
echo "strict_ssl_write_shutdown=$STRICT_SSL_WRITE_SHUTDOWN" >> /etc/vsftpd.conf
echo "syslog_enable=$SYSLOG_ENABLE" >> /etc/vsftpd.conf
echo "tcp_wrappers=$TCP_WRAPPERS" >> /etc/vsftpd.conf
echo "text_userdb_names=$TEXT_USERDB_NAMES" >> /etc/vsftpd.conf
echo "tilde_user_enable=$TILDE_USER_ENABLE" >> /etc/vsftpd.conf
echo "use_localtime=$USE_LOCALTIME" >> /etc/vsftpd.conf
echo "use_sendfile=$USE_SENDFILE" >> /etc/vsftpd.conf
echo "userlist_deny=$USERLIST_DENY" >> /etc/vsftpd.conf
echo "userlist_enable=$USERLIST_ENABLE" >> /etc/vsftpd.conf
echo "validate_cert=$VALIDATE_CERT" >> /etc/vsftpd.conf
echo "virtual_use_local_privs=$VIRTUAL_USE_LOCAL_PRIVS" >> /etc/vsftpd.conf
echo "write_enable=$WRITE_ENABLE" >> /etc/vsftpd.conf
echo "xferlog_enable=$XFERLOG_ENABLE" >> /etc/vsftpd.conf
echo "xferlog_std_format=$XFERLOG_STD_FORMAT" >> /etc/vsftpd.conf
echo "accept_timeout=$ACCEPT_TIMEOUT" >> /etc/vsftpd.conf
echo "anon_max_rate=$ANON_MAX_RATE" >> /etc/vsftpd.conf
echo "anon_umask=$ANON_UMASK" >> /etc/vsftpd.conf
echo "chown_upload_mode=$CHOWN_UPLOAD_MODE" >> /etc/vsftpd.conf
echo "connect_timeout=$CONNECT_TIMEOUT" >> /etc/vsftpd.conf
echo "data_connection_timeout=$DATA_CONNECTION_TIMEOUT" >> /etc/vsftpd.conf
echo "delay_failed_login=$DELAY_FAILED_LOGIN" >> /etc/vsftpd.conf
echo "delay_successful_login=$DELAY_SUCCESSFUL_LOGIN" >> /etc/vsftpd.conf
echo "file_open_mode=$FILE_OPEN_MODE" >> /etc/vsftpd.conf
echo "ftp_data_port=$FTP_DATA_PORT" >> /etc/vsftpd.conf
echo "idle_session_timeout=$IDLE_SESSION_TIMEOUT" >> /etc/vsftpd.conf
echo "listen_port=$LISTEN_PORT" >> /etc/vsftpd.conf
echo "local_max_rate=$LOCAL_MAX_RATE" >> /etc/vsftpd.conf
echo "local_umask=$LOCAL_UMASK" >> /etc/vsftpd.conf
echo "max_clients=$MAX_CLIENTS" >> /etc/vsftpd.conf
echo "max_login_fails=$MAX_LOGIN_FAILS" >> /etc/vsftpd.conf
echo "max_per_ip=$MAX_PER_IP" >> /etc/vsftpd.conf
echo "pasv_max_port=$PASV_MAX_PORT" >> /etc/vsftpd.conf
echo "pasv_min_port=$PASV_MIN_PORT" >> /etc/vsftpd.conf
echo "trans_chunk_size=$TRANS_CHUNK_SIZE" >> /etc/vsftpd.conf
echo "anon_root=$ANON_ROOT" >> /etc/vsftpd.conf
echo "banned_email_file=$BANNED_EMAIL_FILE" >> /etc/vsftpd.conf
echo "banner_file=$BANNER_FILE" >> /etc/vsftpd.conf
echo "ca_certs_file=$CA_CERTS_FILE" >> /etc/vsftpd.conf
echo "chown_username=$CHOWN_USERNAME" >> /etc/vsftpd.conf
echo "chroot_list_file=$CHROOT_LIST_FILE" >> /etc/vsftpd.conf
echo "cmds_allowed=$CMDS_ALLOWED" >> /etc/vsftpd.conf
echo "cmds_denied=$CMDS_DENIED" >> /etc/vsftpd.conf
echo "deny_file=$DENY_FILE" >> /etc/vsftpd.conf
echo "dsa_cert_file=$DSA_CERT_FILE" >> /etc/vsftpd.conf
echo "dsa_private_key_file=$DSA_PRIVATE_KEY_FILE" >> /etc/vsftpd.conf
echo "email_password_file=$EMAIL_PASSWORD_FILE" >> /etc/vsftpd.conf
echo "ftp_username=$FTP_USERNAME" >> /etc/vsftpd.conf
echo "ftpd_banner=$FTPD_BANNER" >> /etc/vsftpd.conf
echo "guest_username=$GUEST_USERNAME" >> /etc/vsftpd.conf
echo "hide_file=$HIDE_FILE" >> /etc/vsftpd.conf
echo "listen_address=$LISTEN_ADDRESS" >> /etc/vsftpd.conf
echo "listen_address6=$LISTEN_ADDRESS6" >> /etc/vsftpd.conf
echo "local_root=$LOCAL_ROOT" >> /etc/vsftpd.conf
echo "message_file=$MESSAGE_FILE" >> /etc/vsftpd.conf
echo "nopriv_user=$NOPRIV_USER" >> /etc/vsftpd.conf
echo "pam_service_name=$PAM_SERVICE_NAME" >> /etc/vsftpd.conf
echo "pasv_address=$PASV_ADDRESS" >> /etc/vsftpd.conf
echo "rsa_cert_file=$RSA_CERT_FILE" >> /etc/vsftpd.conf
echo "rsa_private_key_file=$RSA_PRIVATE_KEY_FILE" >> /etc/vsftpd.conf
echo "secure_chroot_dir=$SECURE_CHROOT_DIR" >> /etc/vsftpd.conf
echo "ssl_ciphers=$SSL_CIPHERS" >> /etc/vsftpd.conf
echo "user_config_dir=$USER_CONFIG_DIR" >> /etc/vsftpd.conf
echo "user_sub_token=$USER_SUB_TOKEN" >> /etc/vsftpd.conf
echo "userlist_file=$USERLIST_FILE" >> /etc/vsftpd.conf
echo "vsftpd_log_file=$VSFTPD_LOG_FILE" >> /etc/vsftpd.conf
echo "xferlog_file=$XFERLOG_FILE" >> /etc/vsftpd.conf

# create SECURE_CHROOT_DIR dir
mkdir -p $SECURE_CHROOT_DIR

# Execute vsftpd server
/usr/sbin/vsftpd /etc/vsftpd.conf